<mvc:View
  id="screen3View"
  controllerName="apptracciabilita.apptracciabilita.controller.Screen3"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:mdc="sap.ui.mdc"
  xmlns:mdctable="sap.ui.mdc.table"
  displayBlock="true">

  <Page id="page3" title="Tracciabilità" enableScrolling="false" class="sapUiNoContentPadding fullHeightPage">

    <customHeader>
      <Toolbar id="toolbar3" class="appCustomHeader">
        <Bar id="bar3">
          <contentLeft>
            <Image id="imageLogo3" src="IMG/Valentino.png" decorative="false" width="200px" class="hideLogo"/>
            <Button id="buttonBack3" icon="sap-icon://nav-back" press=".onNavBack" type="Transparent"/>
          </contentLeft>
          <contentMiddle>
            <Title id="title3" text="Tracciabilità" level="H3"/>
          </contentMiddle>
          <contentRight>
            <ToolbarSpacer id="bar3SpacerRight"/>
          </contentRight>
        </Bar>
      </Toolbar>
    </customHeader>

    <!-- subHeader: only IBar types allowed (Toolbar / OverflowToolbar / Bar) -->
    <subHeader>
      <OverflowToolbar id="toolbarInfo3" design="Transparent" class="subHeaderBar">

        <!-- Dynamic Header Fields -->
        <HBox
          id="hdr3Dynamic"
          fitContainer="true"
          wrap="Wrap"
          alignItems="Center"
          visible="{= ${detail>/Header3Fields} &amp;&amp; ${detail>/Header3Fields}.length > 0 }"
          items="{detail>/Header3Fields}">
          <items>
            <HBox id="hdr3PairTmpl" class="hdrDynPair" alignItems="Center">
              <Label id="hdr3LblTmpl" text="{detail>label}:" design="Bold" class="hdrDynLbl"/>
              <Text id="hdr3ValTmpl" text="{detail>value}" class="hdrDynVal"/>
            </HBox>
          </items>
        </HBox>

        <ToolbarSpacer id="hdr3Spacer"/>

        <!-- ODA Status -->
        <HBox id="hboxOda" alignItems="Center" class="odaStatusChip">
          <Label id="labelOpenODA" text="ODA aperti:" class="odaLabel"/>
          <ObjectStatus
            id="iconOpenOda3"
            text="{= ${detail>/OpenOda} === 'X' ? 'Sì' : 'No' }"
            icon="{= ${detail>/OpenOda} === 'X' ? 'sap-icon://status-completed' : 'sap-icon://status-error' }"
            state="{= ${detail>/OpenOda} === 'X' ? 'Success' : 'Error' }"
            tooltip="{= ${detail>/OpenOda} === 'X' ? 'Esistono ODA aperti' : 'Nessun ODA aperto' }"/>
        </HBox>

      </OverflowToolbar>
    </subHeader>

    <content>

      <!-- Status filter + search + action buttons -->
      <HBox
        id="hboxToolbarTable3"
        width="100%"
        justifyContent="SpaceBetween"
        alignItems="Center"
        class="tableControlBar"
        wrap="Wrap">

        <HBox id="hboxToolbarTable3-1" wrap="Wrap" alignItems="Center" class="filterGroup">

          <HBox id="hboxStatusFilter3" class="statusFilterBox" alignItems="Center" wrap="Wrap">
            <Label id="lblStatus3" text="Stato:" class="sapUiTinyMarginEnd filterLabel"/>
            <ObjectStatus id="stAll3" text="TUTTI" icon="sap-icon://filter" state="None" active="true" press=".onStatusFilterPress" class="statusChip">
              <customData><core:CustomData id="cdStAll3" key="status" value=""/></customData>
            </ObjectStatus>
            <ObjectStatus id="stST3" text="In attesa" icon="sap-icon://circle-task" state="Warning" active="true" press=".onStatusFilterPress" class="statusChip">
              <customData><core:CustomData id="cdStST3" key="status" value="ST"/></customData>
            </ObjectStatus>
            <ObjectStatus id="stAP3" text="Approvato" icon="sap-icon://circle-task" state="Success" active="true" press=".onStatusFilterPress" class="statusChip">
              <customData><core:CustomData id="cdStAP3" key="status" value="AP"/></customData>
            </ObjectStatus>
            <ObjectStatus id="stRJ3" text="Respinto" icon="sap-icon://circle-task" state="Error" active="true" press=".onStatusFilterPress" class="statusChip">
              <customData><core:CustomData id="cdStRJ3" key="status" value="RJ"/></customData>
            </ObjectStatus>
            <ObjectStatus id="stCH3" text="Modificato" icon="sap-icon://circle-task" state="Information" active="true" press=".onStatusFilterPress" class="statusChip">
              <customData><core:CustomData id="cdStCH3" key="status" value="CH"/></customData>
            </ObjectStatus>
          </HBox>

          <HBox id="hboxFilter3" alignItems="Center" class="searchFilterBox">
            <Label id="lblFilter3" text="Cercare:" labelFor="inputFilter3" class="sapUiTinyMarginEnd filterLabel"/>
            <Input id="inputFilter3" width="100%" liveChange=".onGlobalFilter" placeholder="Filtro testuale su tutti i campi" class="searchInput"/>
            <Button id="btnColFilters5" icon="sap-icon://filter" tooltip="Filtri per colonna" press=".onOpenColumnFilters" type="Transparent"/>
            <Button id="btnSort5" icon="sap-icon://sort" tooltip="Ordinamento" press=".onOpenSort" type="Transparent"/>
            <Button id="btnResetFS5" icon="sap-icon://reset" tooltip="Reset filtri/ordinamento" press=".onResetFiltersAndSort" type="Transparent"/>
          </HBox>

        </HBox>

        <Toolbar id="tblToolbar3" design="Transparent" class="actionToolbar">
          <ToolbarSpacer id="footerToolbar532"/>
          <Button id="btnAddRow01" text="Aggiungi riga" type="Emphasized" icon="sap-icon://add" enabled="{detail>/__canAddRow}" press=".onAddRow" class="actionBtn"/>
          <Button id="btnCopyRow01" text="Copia riga" type="Default" icon="sap-icon://copy" enabled="{detail>/__canAddRow}" press=".onCopyRow" class="actionBtn"/>
          <Button id="btnDeleteRows01" text="Elimina righe" type="Negative" icon="sap-icon://delete" enabled="{detail>/__canAddRow}" press=".onDeleteRows" class="actionBtn"/>
          <ToolbarSeparator id="tbSep3"/>
          <Button id="btnApprove3" text="Approva" type="Accept" icon="sap-icon://accept" visible="{detail>/__canApprove}" press=".onApprove" class="actionBtn"/>
          <Button id="btnReject3" text="Rifiuta" type="Reject" icon="sap-icon://decline" visible="{detail>/__canReject}" press=".onReject" class="actionBtn"/>
          <ToolbarSeparator id="tbSep3b"/>
          <Button id="tbPrint3" icon="sap-icon://print" tooltip="Stampa" press=".onPrint" type="Transparent"/>
          <Button id="tbExcel3" icon="sap-icon://excel-attachment" tooltip="Excel" press=".onExportExcel" type="Transparent"/>
        </Toolbar>

      </HBox>

      <!-- MDC Table: full width/height, horizontal+vertical scroll -->
      <mdc:Table
        id="mdcTable3"
        type="Table"
        width="100%"
        height="100%"
        selectionMode="Multi"
        p13nMode="Column"
        class="fullSizeTable"
        delegate='{
          "name":"apptracciabilita/apptracciabilita/delegates/MdcGenericTableDelegate",
          "payload":{
            "cfgModel":"vm",
            "cfgPath":"/mdcCfg/screen3",
            "defaultModel":"detail",
            "defaultPath":"/Records"
          }
        }'>
      </mdc:Table>

    </content>

    <footer>
      <OverflowToolbar id="footerToolbar5">
        <ToolbarSpacer id="footerSpacer5"/>
        <Button id="btnSaveLocal5" text="Salva" icon="sap-icon://save" type="Emphasized" press=".onSave"/>
      </OverflowToolbar>
    </footer>

  </Page>
</mvc:View>