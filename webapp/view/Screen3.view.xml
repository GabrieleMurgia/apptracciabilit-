<!-- webapp/view/Screen3.view.xml -->
<mvc:View
  id="screen3View"
  controllerName="apptracciabilita.apptracciabilita.controller.Screen3"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:mdc="sap.ui.mdc"
  xmlns:mdctable="sap.ui.mdc.table">

  <Page id="page3" title="Tracciabilità">

    <customHeader>
      <Toolbar id="toolbar3">
        <Bar id="bar3">
          <contentLeft>
            <Image id="imageLogo3" src="IMG/Valentino.png" decorative="false" width="200px"/>
            <Button
              id="buttonBack3"
              icon="sap-icon://nav-back"
              press=".onNavBack" />
          </contentLeft>

          <contentMiddle>
            <Title id="title3" text="Tracciabilità" />
          </contentMiddle>

          <contentRight>
            <!-- ✅ 3 bottoni in header (come Screen4) -->
            <HBox id="hbox4" width="260px" justifyContent="End" alignItems="Center">

              <Button
                id="tbToggleHeaderFilters3"
                icon="sap-icon://filter"
                tooltip="Mostra/Nascondi filtri colonna"
                press=".onToggleHeaderFilters" />

              <Button
                id="tbToggleHeaderSort3"
                icon="sap-icon://sort"
                tooltip="Mostra/Nascondi sort per colonna"
                press=".onToggleHeaderSort"
                class="sapUiTinyMarginBegin" />

              <Button
                id="tbResetFS3"
                icon="sap-icon://reset"
                tooltip="Reset filtri e ordinamento (header)"
                press=".onResetFiltersAndSort"
                class="sapUiTinyMarginBegin" />

            </HBox>
          </contentRight>
        </Bar>
      </Toolbar>
    </customHeader>

    <subHeader>
      <Toolbar id="toolbarInfo3">
        <Label id="lblVend3" text="Fornitore:" />
        <Text id="txtVend3" text="{detail>/VendorId}" />
        <ToolbarSpacer id="sp1_3" />

        <Label id="lblMat3" text="Materiale:" />
        <Text id="txtMat3" text="{detail>/Material}" />
        <ToolbarSpacer id="sp2_3" />

        <Label id="lblCount3" text="Record:" />
        <Text id="txtCount3" text="{detail>/RecordsCount}" />
      </Toolbar>
    </subHeader>

    <content>
      <VBox id="box3" width="100%">

        <!-- Toolbar: filtri stato + filtro testuale + bottoni -->
        <HBox id="hboxToolbarTable3"
              width="100%"
              justifyContent="End"
              alignItems="Center"
              class="sapUiTinyMargin alignTableButton">

          <HBox id="hboxToolbarTable3-1" class="left20">

            <!-- FILTRI STATO (TUTTI / ST / AP / RJ / CH) -->
            <HBox id="hboxStatusFilter3" class="sapUiTinyMarginEnd left20" alignItems="Center">
              <Label id="lblStatus3" text="Stato:" class="sapUiTinyMarginEnd"/>

              <ObjectStatus
                id="stAll3"
                text="TUTTI"
                icon="sap-icon://filter"
                state="None"
                active="true"
                press=".onStatusFilterPress"
                class="sapUiTinyMarginEnd">
                <customData>
                  <core:CustomData key="status" value=""/>
                </customData>
              </ObjectStatus>

              <ObjectStatus
                id="stST3"
                text="In attesa"
                icon="sap-icon://circle-task"
                state="Warning"
                active="true"
                press=".onStatusFilterPress"
                class="sapUiTinyMarginEnd">
                <customData>
                  <core:CustomData key="status" value="ST"/>
                </customData>
              </ObjectStatus>

              <ObjectStatus
                id="stAP3"
                text="Approvato"
                icon="sap-icon://circle-task"
                state="Success"
                active="true"
                press=".onStatusFilterPress"
                class="sapUiTinyMarginEnd">
                <customData>
                  <core:CustomData key="status" value="AP"/>
                </customData>
              </ObjectStatus>

              <ObjectStatus
                id="stRJ3"
                text="Respinto"
                icon="sap-icon://circle-task"
                state="Error"
                active="true"
                press=".onStatusFilterPress"
                class="sapUiTinyMarginEnd">
                <customData>
                  <core:CustomData key="status" value="RJ"/>
                </customData>
              </ObjectStatus>

              <ObjectStatus
                id="stCH3"
                text="Modificato"
                icon="sap-icon://circle-task"
                state="Information"
                active="true"
                press=".onStatusFilterPress">
                <customData>
                  <core:CustomData key="status" value="CH"/>
                </customData>
              </ObjectStatus>
            </HBox>

            <!-- FILTRO TESTUALE -->
            <HBox id="hboxFilter3" class="sapUiTinyMarginEnd left20-f" alignItems="Center">
              <Label id="lblFilter3" text="Cercare:" labelFor="inputFilter3" class="sapUiTinyMarginEnd"/>
              <Input id="inputFilter3"
                     width="22rem"
                     liveChange=".onGlobalFilter"
                     placeholder="Filtro testuale su tutti i campi"/>

              <Button
                id="btnColFilters5"
                icon="sap-icon://filter"
                tooltip="Filtri per colonna"
                press=".onOpenColumnFilters" />

              <Button
                id="btnSort5"
                icon="sap-icon://sort"
                tooltip="Ordinamento"
                press=".onOpenSort" />

              <Button
                id="btnResetFS5"
                icon="sap-icon://reset"
                tooltip="Reset filtri/ordinamento"
                press=".onResetFiltersAndSort" />
            </HBox>

          </HBox>

          <!-- BOTTONI: print/excel (NO dialog) -->
          <Toolbar id="tblToolbar3" design="Transparent">
            <ToolbarSpacer id="footerToolbar532"/>
              <Button
                id="btnAddRow01"
                text="Aggiungi riga"
                type="Emphasized"
                icon="sap-icon://add"
                enabled="{detail>/__canAddRow}"
                press=".onAddRow" />

              <Button
                id="btnDeleteRows01"
                text="Elimina righe"
                type="Negative"
                icon="sap-icon://delete"
                enabled="{detail>/__canAddRow}"
                press=".onDeleteRows" />
            <Button id="tbPrint3" icon="sap-icon://print" tooltip="Stampa" press=".onPrint"/>
            <Button id="tbExcel3" icon="sap-icon://excel-attachment" tooltip="Excel" press=".onExportExcel"/>
          </Toolbar>

        </HBox>

        <mdc:Table
          id="mdcTable3"
          type="Table"
          width="100%"
          selectionMode="Multi"
          p13nMode="Column"
          delegate='{"name":"apptracciabilita/apptracciabilita/delegates/MdcGenericTableDelegate","payload":{"cfgModel":"vm","cfgPath":"/mdcCfg/screen3"}}'>
          <!-- colonne create in controller -->
        </mdc:Table>

      </VBox>
    </content>

    <footer>
      <OverflowToolbar id="footerToolbar5">
        <ToolbarSpacer id="footerSpacer5"/>
        <Button
          id="btnSaveLocal5"
          text="Salva"
          icon="sap-icon://save"
          type="Emphasized"
          press=".onSave"/>
      </OverflowToolbar>
    </footer>

  </Page>
</mvc:View>
